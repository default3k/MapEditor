<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
        }
        
        .navbar {
            background-color: #1a1a1a !important;
            border-bottom: 1px solid #333;
        }
        
        .navbar-brand {
            color: #e0e0e0 !important;
        }
        
        .container {
            background-color: #1a1a1a;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        h2 {
            color: #e0e0e0;
        }
        
        .card {
            background-color: #2d2d2d;
            border: 1px solid #444;
            transition: transform 0.3s, box-shadow 0.3s;
            border-radius: 10px;
            overflow: hidden;
        }
        
        
        .card-img-top {
            height: 200px;
            object-fit: cover;
            border-bottom: 1px solid #444;
        }
        
        .card-title {
            color: #e0e0e0;
            font-weight: 600;
        }
        
        .card-text.text-muted {
            color: #aaa !important;
        }
        
        .card-footer {
            background-color: #252525;
            border-top: 1px solid #444;
            padding: 1rem 1.25rem;
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω—ã–µ –±–µ–π–¥–∂–∏ —Ä–µ–∂–∏–º–æ–≤ */
        .mode-badge {
            font-size: 0.8em;
            padding: 5px 12px;
            border-radius: 15px;
            margin-left: 8px;
            font-weight: 600;
            letter-spacing: 0.5px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .mode-random { 
            background: linear-gradient(135deg, #6f42c1 0%, #8a63d2 100%);
            color: white; 
        }
        .mode-attack_defense { 
            background: linear-gradient(135deg, #dc3545 0%, #e35d6a 100%);
            color: white; 
        }
        .mode-encounter { 
            background: linear-gradient(135deg, #fd7e14 0%, #ff9c46 100%);
            color: white; 
        }
        .mode-assault { 
            background: linear-gradient(135deg, #d63384 0%, #e55fa1 100%);
            color: white; 
        }
        .mode-grand_battle { 
            background: linear-gradient(135deg, #0d6efd 0%, #4d8ffd 100%);
            color: white; 
        }
        .mode-clash { 
            background: linear-gradient(135deg, #20c997 0%, #4dd4ac 100%);
            color: white; 
        }
        
        /* –§–æ—Ä–º—ã –∏ –∫–Ω–æ–ø–∫–∏ */
        .form-control {
            background-color: #2d2d2d;
            border: 1px solid #444;
            color: #e0e0e0;
        }
        
        .form-control:focus {
            background-color: #333;
            border-color: #666;
            color: #fff;
            box-shadow: 0 0 0 0.25rem rgba(100, 100, 100, 0.25);
        }
        
        .input-group-text {
            background-color: #333;
            border: 1px solid #444;
            color: #aaa;
        }
        
        .btn {
            border-radius: 6px;
            transition: all 0.2s;
            font-weight: 500;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #198754 0%, #20c997 100%);
            border: none;
        }
        
        .btn-success:hover {
            background: linear-gradient(135deg, #157347 0%, #1baa7e 100%);
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #0a58ca 0%, #3d8bfd 100%);
            border: none;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #0a4da8 0%, #2d7cfd 100%);
            transform: translateY(-2px);
        }
        
        .btn-outline-secondary {
            border-color: #666;
            color: #aaa;
        }
        
        .btn-outline-secondary:hover {
            background-color: #666;
            border-color: #666;
            color: #fff;
            transform: translateY(-1px);
        }
        
        /* –ö—Ä–∞—Å–∏–≤—ã–µ –∫–Ω–æ–ø–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ */
        .filter-section {
            background-color: #252525;
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            border: 1px solid #444;
        }
        
        .filter-title {
            color: #e0e0e0;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-btn {
            border-radius: 20px;
            padding: 8px 18px;
            margin: 5px;
            background-color: #333;
            border: 1px solid #444;
            color: #aaa;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .filter-btn:hover {
            background-color: #3a3a3a;
            border-color: #555;
            color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .active-filter {
            background: linear-gradient(135deg, #0a58ca 0%, #3d8bfd 100%) !important;
            border-color: #0a58ca !important;
            color: white !important;
            font-weight: 600;
        }
        
        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª—å—Ç—Ä–∞—Ö */
        .filter-info {
            background-color: #1c2b3a;
            padding: 12px 20px;
            border-radius: 8px;
            margin-top: 1.5rem;
            border-left: 4px solid #0a58ca;
        }
        
        .filter-info small {
            color: #a0c8ff;
        }
        
        /* Alert */
        .alert-info {
            background-color: #1c2b3a;
            border-color: #2a4365;
            color: #a0c8ff;
            border-radius: 8px;
        }
        
        .alert-info .alert-link {
            color: #7ab8ff;
        }
        
        code {
            background-color: #2d2d2d;
            color: #e0e0e0;
            padding: 2px 6px;
            border-radius: 4px;
            border: 1px solid #444;
        }
        
        .text-muted {
            color: #888 !important;
        }
        
        .text-success {
            color: #75b798 !important;
        }
        
        .text-danger {
            color: #e57373 !important;
        }
        
        /* –£–ª—É—á—à–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —Å—Å—ã–ª–æ–∫ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö */
        .card a {
            text-decoration: none;
        }
        
        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                margin-top: 10px;
            }
            
            .d-flex {
                flex-direction: column;
                gap: 15px;
            }
            
            .filter-btn {
                padding: 6px 12px;
                font-size: 0.85rem;
                margin: 3px;
            }
            
            .btn-success, .btn-primary {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">üó∫Ô∏è –†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞—Ä—Ç WoT</a>
        </div>
    </nav>
    
    <div class="container mt-4">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∫–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞—Ä—Ç—ã</h2>
            <a href="/admin/maps/gamemap/add/" class="btn btn-success">
                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É
            </a>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª—å –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
        <div class="card mb-4">
            <div class="card-body">
                <!-- –¢–æ–ª—å–∫–æ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ (–±–µ–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞) -->
                <form method="get" class="search-form">
                    <div class="row g-3">
                        <!-- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é -->
                        <div class="col-md-12">
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-search"></i></span>
                                <input type="text" 
                                       name="search" 
                                       class="form-control" 
                                       placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–∞—Ä—Ç—ã..." 
                                       value="{{ search_query }}">
                                {% if search_query %}
                                <a href="?{% if mode_filter %}mode={{ mode_filter }}&{% endif %}" 
                                   class="btn btn-outline-secondary" 
                                   title="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫">
                                    <i class="fas fa-times"></i>
                                </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </form>
                
                <!-- –¢–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º–∞–º (–±–µ–∑ "–î—Ä—É–≥–æ–≥–æ") -->
                <div class="filter-section">
                    <div class="filter-title">
                        <i class="fas fa-filter"></i> –§–∏–ª—å—Ç—Ä –ø–æ —Ä–µ–∂–∏–º–∞–º:
                    </div>
                    <div>
                        <a href="?{% if search_query %}search={{ search_query }}&{% endif %}" 
                           class="btn filter-btn {% if not mode_filter %}active-filter{% endif %}">
                            –í—Å–µ —Ä–µ–∂–∏–º—ã
                        </a>
                        {% for value, label in mode_choices %}
                            {% if value != 'other' %}  <!-- –ò—Å–∫–ª—é—á–∞–µ–º "–î—Ä—É–≥–æ–π" -->
                            <a href="?{% if search_query %}search={{ search_query }}&{% endif %}mode={{ value }}" 
                               class="btn filter-btn {% if mode_filter == value %}active-filter{% endif %}">
                                {{ label }}
                            </a>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
                
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª—å—Ç—Ä–∞—Ö -->
                {% if search_query or mode_filter %}
                <div class="filter-info">
                    <small>
                        {% if search_query %}<i class="fas fa-search"></i> –ü–æ–∏—Å–∫: "<strong>{{ search_query }}</strong>"{% endif %}
                        {% if mode_filter %} | <i class="fas fa-gamepad"></i> –†–µ–∂–∏–º: <strong>{{ mode_filter|capfirst }}</strong>{% endif %}
                        {% if total_maps == 0 %}
                            <span class="text-danger"> - –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</span>
                        {% else %}
                            <span class="text-success"> - –ù–∞–π–¥–µ–Ω–æ: {{ total_maps }}</span>
                        {% endif %}
                        <a href="?" class="ms-2"><i class="fas fa-times-circle"></i> –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</a>
                    </small>
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- –°–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç -->
        {% if maps %}
        <div class="row">
            {% for map in maps %}
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <img src="{{ map.image.url }}" 
                         class="card-img-top" 
                         alt="{{ map.name }}" 
                         onerror="this.src='https://via.placeholder.com/400x200/333/666?text=–ö–∞—Ä—Ç–∞+WoT'">
                    
                    <div class="card-body">
                        <h5 class="card-title d-flex justify-content-between align-items-start">
                            {{ map.name }}
                            {% if map.mode != 'other' %}  <!-- –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±–µ–π–¥–∂ –¥–ª—è "–î—Ä—É–≥–æ–≥–æ" -->
                            <span class="mode-badge mode-{{ map.mode }}">
                                {{ map.get_mode_display_name }}
                            </span>
                            {% endif %}
                        </h5>
                        
                        <p class="card-text text-muted">
                            <small>
                                <i class="fas fa-calendar"></i> –°–æ–∑–¥–∞–Ω–∞: {{ map.created_at|date:"d.m.Y" }}<br>
                                <i class="fas fa-user"></i> –ê–≤—Ç–æ—Ä: {{ map.created_by.username }}
                            </small>
                        </p>
                    </div>
                    
                    <div class="card-footer bg-transparent border-top-0">
                        <a href="{% url 'map_detail' map.id %}" class="btn btn-primary w-100">
                            <i class="fas fa-paint-brush"></i> –û—Ç–∫—Ä—ã—Ç—å –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è
                        </a>
                        {% if request.user.is_superuser %}
                        <a href="/admin/maps/gamemap/{{ map.id }}/change/" 
                           class="btn btn-outline-secondary btn-sm w-100 mt-2">
                            <i class="fas fa-cog"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ—Ç –∫–∞—Ä—Ç -->
        <div class="alert alert-info">
            <h4><i class="fas fa-info-circle"></i> –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞—Ä—Ç</h4>
            <p>–î–æ–±–∞–≤—å—Ç–µ –∫–∞—Ä—Ç—É —á–µ—Ä–µ–∑ <a href="/admin/maps/gamemap/add/">–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>.</p>
            
            {% if search_query or mode_filter %}
            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:</p>
            <ul>
                <li>–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</li>
                <li>–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã: <a href="?" class="alert-link">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–∞—Ä—Ç—ã</a></li>
                <li>–í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —Ä–µ–∂–∏–º –∏–≥—Ä—ã</li>
            </ul>
            {% else %}
            <p>–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</p>
            <code>python manage.py createsuperuser</code>
            {% endif %}
        </div>
        {% endif %}
    </div>

</body>
</html>